---
title: "Examples of regression estimators with different rho functions"
author: "Matias Salibian-Barrera"
date: "`r format(Sys.Date())`"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, fig.width=6, fig.height=6, tidy=TRUE)  
                      #warning=FALSE, message=FALSE, tidy=TRUE) #, eval = FALSE)
```

Here are some examples illustrating the use of `lmrobdetMM()` and `lmrobdetDCML()`
with different choices of rho functions (bisquare, optimal and modified optimal). 

First, we load the library:
```{r load}
library(RobStatTM)
```
The first example uses the `coleman` data available in the `robustbase` package. 
By default `lmrobdetMM` uses a bisquare rho tuned to 85% asymptotic efficiency
for Gaussian errors. The default breakdown point is 50%. 
```{r ex1}
data(coleman, package='robustbase')
coef( m2 <- lmrobdetMM(Y ~ ., data=coleman) )
coef( m0 <- lm(Y ~ ., data=coleman) )
```
To use the optimal or modified optimal rho (also with default asymptotic efficiency
of 85%), we use
```{r ex2}
coef( m4 <- lmrobdetMM(Y ~ ., data=coleman, control=lmrobdet.control(family='modified.optimal')) )
coef( m5 <- lmrobdetMM(Y ~ ., data=coleman, control=lmrobdet.control(family='optimal')) )
```
The algorithm failed to converge when using the `optimal` rho.

### DCML 

The DCML estimator is "between" the MM
one and the LS one, as expected:
```{r dcml1}
coef( m1 <- lmrobdetDCML(Y ~ ., data=coleman) )
coef( m2 )
coef( m0 )
```
Similarly, when we use a non-bisquare rho function:
```{r dcml2}
coef( m10 <- lmrobdetDCML(Y ~ ., data=coleman, control=lmrobdet.control(family='modified.optimal')) )
coef( m4 )
coef( m0 )
```

### Unintuitive behaviour of `modified.optimal`

A behaviour that appears to be unintuitive is that as we increase the desired
asymptotic efficiency, the estimators computed with the optimal / modified optimal rho
do not seem to get closer to the least squares one.

When using the bisquare family of rho, as we increase the desired asymptotic efficiency, the
MM-estimator approaches the least squares one. For example
```{r ex3}
coef( m2.eff <- lmrobdetMM(Y ~ ., data=coleman, control=lmrobdet.control(efficiency=.9999)) )
coef( m0 )
```
Something similar happens for the `DCML` estimator based on an MM-estimator computed with 
a `bisquare` rho function, which seems to be identical to the least squares estimator:
```{r ex4}
coef( m3 <- lmrobdetDCML(Y ~ ., data=coleman, control=lmrobdet.control(efficiency=.9999)) )
```

However, if we use a `modified.optimal` rho, the results are very different:
```{r ex5}
coef( m7 <- lmrobdetMM(Y ~ ., data=coleman, 
                 control=lmrobdet.control(family='modified.optimal', efficiency=.9999) ) )
coef( m6 <- lmrobdetDCML(Y ~ ., data=coleman, 
                         control=lmrobdet.control(family='modified.optimal', efficiency=.9999)) )
coef( m0 )
```

